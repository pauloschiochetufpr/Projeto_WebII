<div class="p-6 w-full max-w-xl bg-white rounded-lg shadow-lg">
  <!-- Cabeçalho -->
  <div class="flex items-center justify-between border-b pb-3 mb-4">
    <h2 class="text-xl font-bold text-gray-800 flex items-center gap-2">
      <span class="w-3 h-3 rounded-full bg-green-500"></span>
      Solicitação do Cliente
    </h2>

    <!-- Badge de Status -->
    <span
      class="px-3 py-1 text-xs rounded-full font-medium"
      [ngClass]="{
        'bg-gray-200 text-gray-700': data.state === 'ABERTA',
        'bg-yellow-100 text-yellow-700': data.state === 'ORÇADA',
        'bg-green-100 text-green-700': data.state === 'APROVADA',
        'bg-red-100 text-red-700': data.state === 'REJEITADA',
        'bg-blue-100 text-blue-700': data.state === 'ARRUMADA',
        'bg-orange-100 text-orange-700': data.state === 'PAGA',
        'bg-emerald-100 text-emerald-700': data.state === 'FINALIZADA'
      }"
    >
      {{ data.state }}
    </span>
  </div>

  <!-- Dados principais -->
  <div class="grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg mb-6 text-sm">
    <p><strong>ID:</strong> {{ data.id ?? data.idSolicitacao }}</p>
    <p><strong>Nome:</strong> {{ data.nome ?? data.name }}</p>
    <p><strong>Data/Hora:</strong> {{ data.dataHora ?? data.createdAt | date:'short' }}</p>

    <!-- Tempo desde abertura -->
    <p *ngIf="data.createdAt">
      <strong>Aberta há:</strong> {{ calcularTempoDecorrido(data.createdAt) }}
    </p>

    <p class="col-span-2">
      <strong>Descrição:</strong> {{ data.descricao ?? data.description ?? '—' }}
    </p>
    <p *ngIf="data.valor" class="col-span-2">
      <strong>Valor:</strong> R$ {{ data.valor }}
    </p>
  </div>

  <!-- Mensagem dinâmica -->
  <div class="mb-6 p-3 rounded-lg border text-sm"
      [ngClass]="{
  'bg-sky-50 text-sky-700 border-sky-200': data.state === 'ABERTA',
  'bg-yellow-50 text-yellow-800 border-yellow-200': data.state === 'ORÇADA',
  'bg-green-50 text-green-800 border-green-200': data.state === 'APROVADA',
  'bg-red-50 text-red-700 border-red-200': data.state === 'REJEITADA',
  'bg-blue-50 text-blue-700 border-blue-200': data.state === 'ARRUMADA',
  'bg-orange-50 text-orange-700 border-orange-200': data.state === 'PAGA',
  'bg-emerald-50 text-emerald-700 border-emerald-200': data.state === 'FINALIZADA'
  }"

  >
    <ng-container [ngSwitch]="data.state">
      <p *ngSwitchCase="'ABERTA'">Sua solicitação foi registrada e está aguardando análise do funcionário.</p>
      <p *ngSwitchCase="'ORÇADA'">Um orçamento está disponível. Você pode aprovar ou rejeitar abaixo.</p>
      <p *ngSwitchCase="'APROVADA'">O serviço foi aprovado e está em manutenção. Aguarde o término.</p>
      <p *ngSwitchCase="'REJEITADA'">O orçamento foi rejeitado. Caso tenha mudado de ideia, entre em contato com o suporte.</p>
      <p *ngSwitchCase="'ARRUMADA'">O serviço foi concluído. Você pode efetuar o pagamento abaixo.</p>
      <p *ngSwitchCase="'PAGA'">Pagamento confirmado. O serviço será finalizado em breve.</p>
      <p *ngSwitchCase="'FINALIZADA'">Serviço concluído! Obrigado por confiar em nossa equipe.</p>
      <p *ngSwitchDefault>Verifique o status da sua solicitação acima.</p>
    </ng-container>
  </div>

  <!-- Ações -->
  <div class="space-y-4">
    <!-- Orçamento -->
    <div *ngIf="data.state === 'ORÇADA'" class="flex gap-2">
      <button
        (click)="aprovar()"
        class="px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded transition"
      >
        Aprovar
      </button>
      <button
        (click)="rejeitar()"
        class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded transition"
      >
        Rejeitar
      </button>
    </div>

    <!-- Pagamento -->
    <div *ngIf="data.state === 'ARRUMADA'" class="flex gap-2">
      <button
        (click)="pagar()"
        class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded transition"
      >
        Pagar
      </button>
    </div>
  </div>

  <!-- Fechar -->
  <div class="mt-8 text-right border-t pt-4">
    <button
      (click)="close()"
      class="px-4 py-2 bg-gray-400 hover:bg-gray-500 text-white rounded"
    >
      Fechar
    </button>
  </div>
</div>
